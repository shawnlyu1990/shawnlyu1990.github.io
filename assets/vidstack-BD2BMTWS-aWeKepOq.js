var F=e=>{throw TypeError(e)};var v=(e,h,t)=>h.has(e)||F("Cannot "+t);var a=(e,h,t)=>(v(e,h,"read from private field"),t?t.call(e):h.get(e)),u=(e,h,t)=>h.has(e)?F("Cannot add the same private member more than once"):h instanceof WeakSet?h.add(e):h.set(e,t),y=(e,h,t,i)=>(v(e,h,"write to private field"),i?i.call(e,t):h.set(e,t),t),r=(e,h,t)=>(v(e,h,"access private method"),t);import{aH as S,aQ as B,aI as I,F as d,aR as Q,g as R,a1 as b,a0 as T,bl as j}from"./app-0bwqAuuC.js";var o,s,O,N,P,f,A,m,L,w,x,H,C,M,$,k=($=class extends S{constructor(){super(...arguments);u(this,s);u(this,o);u(this,m,"")}onSetup(){y(this,o,I()),r(this,s,L).call(this),r(this,s,w).call(this),r(this,s,x).call(this),r(this,s,P).call(this)}onAttach(t){t.style.setProperty("pointer-events","none"),d(r(this,s,A).bind(this)),d(r(this,s,L).bind(this)),d(r(this,s,w).bind(this)),d(r(this,s,x).bind(this)),d(r(this,s,P).bind(this));let{started:i}=a(this,o).$state;this.setAttributes({"data-visible":()=>!i()&&!this.$state.hidden(),"data-loading":r(this,s,f).bind(this),"data-error":r(this,s,O).bind(this),"data-hidden":this.$state.hidden})}onConnect(t){d(r(this,s,N).bind(this)),d(r(this,s,H).bind(this))}},o=new WeakMap,s=new WeakSet,O=function(){let{error:t}=this.$state;return!Q(t())},N=function(){let{canLoadPoster:t,poster:i}=a(this,o).$state;!t()&&i()&&R(i(),"preconnect")},P=function(){let{src:t}=this.$props,{poster:i,nativeControls:n}=a(this,o).$state;this.el&&b(this.el,"display",n()?"none":null),this.$state.hidden.set(r(this,s,O).call(this)||!(t()||i())||n())},f=function(){let{loading:t,hidden:i}=this.$state;return!i()&&t()},A=function(){let t=this.$state.img();t&&(new T(t).add("load",r(this,s,C).bind(this)).add("error",r(this,s,M).bind(this)),t.complete&&r(this,s,C).call(this))},m=new WeakMap,L=function(){let{poster:t}=a(this,o).$props,{canLoadPoster:i,providedPoster:n,inferredPoster:p}=a(this,o).$state,c=this.$props.src()||"",E=c||t()||p();a(this,m)===n()&&n.set(c),this.$state.src.set(i()&&E.length?E:null),y(this,m,c)},w=function(){let{src:t}=this.$props,{alt:i}=this.$state,{poster:n}=a(this,o).$state;i.set(t()||n()?this.$props.alt():null)},x=function(){let{crossOrigin:t}=this.$props,{crossOrigin:i}=this.$state,{crossOrigin:n,poster:p}=a(this,o).$state,c=t()!==null?t():n();i.set(/ytimg\.com|vimeo/.test(p()||"")?null:c===!0?"anonymous":c)},H=function(){let{loading:t,error:i}=this.$state,{canLoadPoster:n,poster:p}=a(this,o).$state;t.set(n()&&!!p()),i.set(null)},C=function(){let{loading:t,error:i}=this.$state;t.set(!1),i.set(null)},M=function(t){let{loading:i,error:n}=this.$state;i.set(!1),n.set(t)},$.props={src:null,alt:null,crossOrigin:null},$.state=new B({img:null,src:null,alt:null,crossOrigin:null,loading:!0,error:null,hidden:!1}),$),l,g,D=(g=class extends j(HTMLElement,k){constructor(){super(...arguments);u(this,l,document.createElement("img"))}onSetup(){this.$state.img.set(a(this,l))}onConnect(){let{src:t,alt:i,crossOrigin:n}=this.$state;d(()=>{let{loading:p,hidden:c}=this.$state;a(this,l).style.display=p()||c()?"none":""}),d(()=>{b(a(this,l),"alt",i()),b(a(this,l),"crossorigin",n()),b(a(this,l),"src",t())}),a(this,l).parentNode!==this&&this.prepend(a(this,l))}},l=new WeakMap,g.tagName="media-poster",g.attrs={crossOrigin:"crossorigin"},g);export{D as MediaPosterElement};
