import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,d as e,o as l}from"./app-BICfmULO.js";const n={};function t(h,i){return l(),a("div",null,i[0]||(i[0]=[e(`<div class="hint-container tip"><p class="hint-container-title">提示</p><p>在本例中，宿主机操作系统使用 CentOS 7.9.2009，容器服务使用 Docker 提供。</p></div><details class="hint-container details"><summary><strong>php 5.5.38 (带 Apache) 安装 mysql 扩展</strong></summary><ol><li><p>拉取 php 官方容器镜像</p><p>我这里拉取的是 php 官方 5.5.38 版本，带 apache 的镜像。</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pull</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php:5.5.38-apache</span></span></code></pre></div></li><li><p>安装 php 扩展</p><p><strong>方法1：手动安装</strong></p><p>将容器镜像运行起来。</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -itd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> webserver</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 3580:80</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> php:5.5.38-apache</span></span></code></pre></div><p>进入容器控制台。</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> exec</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -it</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> webserver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /bin/bash</span></span></code></pre></div><p>默认情况下，镜像内部是没有安装 mysql、mysqli 扩展的，在碰到需要连接 mysql 的场景下，可能会出现如下错误：</p><div class="language-log line-numbers-mode" data-highlighter="shiki" data-ext="log" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Uncaught </span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">Error</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: Call to undefined function mysql_connect() in /var/www/html</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>手动安装扩展的方法如下</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/bin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">./docker-php-ext-install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysql</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">./docker-php-ext-install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysqli</span></span></code></pre></div><p><strong>方法2：通过 Dockerfile 安装</strong></p><p>在宿主机中创建一个 Dockerfile 文件。</p><div class="language-dockerfile line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="dockerfile" style="--vp-collapsed-lines:15;--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 使用官方 PHP 镜像作为基础</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> php:5.5.38-apache</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 安装 MySQL 客户端</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">RUN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> docker-php-ext-install mysql mysqli</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 拷贝网站数据</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将 Dockerfile 同目录下的 website 文件夹拷贝到容器的 /var/www/html/ 目录下</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ADD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> website /var/www/html/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将 website 目录下的内容移动到网站根目录下</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">RUN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> mv /var/www/html/website/* /var/www/html/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">RUN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> rm -rf /var/www/html/website</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 指定工作目录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">WORKDIR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /var/www/html</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 暴露80端口</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">EXPOSE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> 80</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 启动Apache和MySQL</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">CMD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;apache2-foreground&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div><p>构建 Docker 镜像</p><div class="language-bash" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">docker</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> build</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -t</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mywebsite</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .</span></span></code></pre></div><p>这将使用当前目录下的 Dockerfile 构建一个名为 mywebsite 的镜像。</p></li></ol></details>`,2)]))}const r=s(n,[["render",t]]),d=JSON.parse('{"path":"/posts/Config/Docker/FAQ/2025-05-12-%E5%9C%A8php%E5%AE%98%E6%96%B9%E5%AE%B9%E5%99%A8%E4%B8%AD%E5%AE%89%E8%A3%85%E7%BC%BA%E5%B0%91%E7%9A%84%E6%89%A9%E5%B1%95.html","title":"在 php 官方容器中安装缺少的扩展","lang":"zh-CN","frontmatter":{"title":"在 php 官方容器中安装缺少的扩展","shortTitle":"在 php 官方容器中安装缺少的扩展","description":"在 php 官方容器中安装缺少的扩展","icon":"/assets/blogicons/Docker.png","author":null,"isOriginal":true,"date":"2025-05-12T00:00:00.000Z","categories":["Docker"],"tags":["Docker","php"],"license":"MIT","sticky":false,"star":true,"article":true,"timeline":true,"comment":false,"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"在 php 官方容器中安装缺少的扩展\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2025-05-12T00:00:00.000Z\\",\\"dateModified\\":\\"2025-05-20T08:11:56.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"昌霖学长\\",\\"email\\":\\"shawnlyu1990@gmail.com\\"}]}"],["meta",{"property":"og:url","content":"https://shawnlyu1990.github.io/posts/Config/Docker/FAQ/2025-05-12-%E5%9C%A8php%E5%AE%98%E6%96%B9%E5%AE%B9%E5%99%A8%E4%B8%AD%E5%AE%89%E8%A3%85%E7%BC%BA%E5%B0%91%E7%9A%84%E6%89%A9%E5%B1%95.html"}],["meta",{"property":"og:site_name","content":"昌霖学长的自习室"}],["meta",{"property":"og:title","content":"在 php 官方容器中安装缺少的扩展"}],["meta",{"property":"og:description","content":"在 php 官方容器中安装缺少的扩展"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-05-20T08:11:56.000Z"}],["meta",{"property":"article:tag","content":"php"}],["meta",{"property":"article:tag","content":"Docker"}],["meta",{"property":"article:published_time","content":"2025-05-12T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-05-20T08:11:56.000Z"}]]},"git":{"createdTime":1747728716000,"updatedTime":1747728716000,"contributors":[{"name":"Shawn Lyu","username":"","email":"shawnlyu1990@gmail.com","commits":1}]},"readingTime":{"minutes":2.13,"words":638},"filePathRelative":"posts/Config/Docker/FAQ/2025-05-12-在php官方容器中安装缺少的扩展.md","excerpt":"","copyright":{"license":"MIT"}}');export{r as comp,d as data};
