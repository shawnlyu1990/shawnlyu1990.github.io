import{w as i,z as s,C as e,K as t}from"./app-CibARIEI.js";const a="/assets/postsimages/2024-07-17-%E5%BC%80%E6%9C%BA%E8%87%AA%E5%8A%A8%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC/01-%E5%B0%86%E8%84%9A%E6%9C%AC%E6%B7%BB%E5%8A%A0%E5%88%B0%E5%BC%80%E6%9C%BA%E5%90%AF%E5%8A%A8.png",n={},l=t(`<div class="hint-container important"><p class="hint-container-title">重要</p><p>本博客系个人学习笔记，内容源自公开出版物及网络资源，如有侵权，请联系删除。</p></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>以下所有的操作步骤都是在 macOS 系统中完成的。</p></div><h2 id="编写脚本" tabindex="-1"><a class="header-anchor" href="#编写脚本"><span>编写脚本</span></a></h2><p>打开终端，创建一个 shell 脚本文件，如 <code>ip_alias.sh</code>，并在文件中输入以下代码：</p><div class="language-zsh line-numbers-mode" data-highlighter="shiki" data-ext="zsh" data-title="zsh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">#!/bin/bash</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /sbin/ifconfig</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> en6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> alias</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 192.168.35.10/24</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>脚本的作用是为 en6 网卡配置一个 IP 别名，就是在网卡已经通过 DHCP 方式获得一个 IP 地址的前提下，在追加一个静态 IP，用于内部的互联使用。</p><h2 id="编辑-sudo-权限" tabindex="-1"><a class="header-anchor" href="#编辑-sudo-权限"><span>编辑 sudo 权限</span></a></h2><p>但该脚本在执行时需要使用 sudo 权限。</p><p>可以通过修改 <code>/etc/sudoers</code> 配置文件，让特定的用户或者用户组在特定的终端上执行特定的命令时不需要输入密码。这样就可以实现在脚本中自动验证 sudo 权限而不需要手动输入密码。</p><div class="hint-container caution"><p class="hint-container-title">警告</p><p>修改 sudoers 文件需要谨慎操作，任何格式错误可能导致你无法使用 sudo 命令恢复系统。因此，在修改 sudoers 文件之前，请务必先备份该文件，并使用 visudo 命令来编辑该文件，以避免格式错误。</p></div><p>具体步骤如下：</p><ol><li><p>编辑 <code>/etc/sudoers</code> 文件</p><div class="language-zsh line-numbers-mode" data-highlighter="shiki" data-ext="zsh" data-title="zsh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> visudo</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>在 <code>/etc/sudoers</code> 文件的 <code>Defaults env_reset</code> 一行下面新增一行</p><div class="language-ssh-config line-numbers-mode" data-highlighter="shiki" data-ext="ssh-config" data-title="/etc/sudoers" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Defaults    env_reset</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Defaults:&lt;username&gt; !requiretty </span><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># 新增</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">……</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># &lt;username&gt;替换成你的用户名</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个配置是在特定的用户下关闭 requiretty 限制，允许该用户在无终端窗口的情况下执行 <code>sudo</code> 命令。</p></li><li><p>接着，在文件的末尾添加如下一行</p><div class="language-ssh-config line-numbers-mode" data-highlighter="shiki" data-ext="ssh-config" data-title="/etc/sudoers" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">……</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;username&gt;      </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">ALL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> = (</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">ALL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">NOPASSWD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: /sbin/ifconfig</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># &lt;username&gt;替换成你的用户名</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># /sbin/ifconfig 是你要无需输入密码执行的命令的绝对路径。</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>保存并退出 <code>/etc/sudoers</code> 文件</p></li></ol><h2 id="配置开机启动" tabindex="-1"><a class="header-anchor" href="#配置开机启动"><span>配置开机启动</span></a></h2><p>最后，在登录项里添加这个脚本，然后测试看有没有问题。没问题就完事了，有问题再相应的修改。</p><figure><img src="`+a+'" alt="将脚本添加到开机启动" tabindex="0" loading="lazy"><figcaption>将脚本添加到开机启动</figcaption></figure>',15),h=[l];function r(d,p){return s(),e("div",null,h)}const c=i(n,[["render",r],["__file","2024-07-17-开机自动执行脚本.html.vue"]]),k=JSON.parse('{"path":"/posts/macOS/2024-07-17-%E5%BC%80%E6%9C%BA%E8%87%AA%E5%8A%A8%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC.html","title":"开机自动执行脚本","lang":"zh-CN","frontmatter":{"title":"开机自动执行脚本","shortTitle":"开机自动执行脚本","description":"目前在 macOS 系统有一个需求，需要在开机登录用户账户之后自动执行一个命令脚本，通常所执行的脚本有些命令是需要用户权限验证的，需要做到无需用户手动输入密码验证，直接运行，这里以一个给网卡自动配置多IP的脚本为例。","icon":"macOS","author":"昌霖学长","isOriginal":false,"date":"2024-07-17T00:00:00.000Z","categories":["macOS"],"tags":["macOS","开机启动"],"license":"MIT","sticky":false,"star":false,"article":true,"timeline":true,"head":[["meta",{"property":"og:url","content":"https://shawnlyu1990.github.io/posts/macOS/2024-07-17-%E5%BC%80%E6%9C%BA%E8%87%AA%E5%8A%A8%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC.html"}],["meta",{"property":"og:site_name","content":"归墟之下"}],["meta",{"property":"og:title","content":"开机自动执行脚本"}],["meta",{"property":"og:description","content":"目前在 macOS 系统有一个需求，需要在开机登录用户账户之后自动执行一个命令脚本，通常所执行的脚本有些命令是需要用户权限验证的，需要做到无需用户手动输入密码验证，直接运行，这里以一个给网卡自动配置多IP的脚本为例。"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://shawnlyu1990.github.io/assets/postsimages/2024-07-17-开机自动执行脚本/01-将脚本添加到开机启动.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-09-02T05:44:26.000Z"}],["meta",{"property":"article:author","content":"昌霖学长"}],["meta",{"property":"article:tag","content":"macOS"}],["meta",{"property":"article:tag","content":"开机启动"}],["meta",{"property":"article:published_time","content":"2024-07-17T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-09-02T05:44:26.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"开机自动执行脚本\\",\\"image\\":[\\"https://shawnlyu1990.github.io/assets/postsimages/2024-07-17-开机自动执行脚本/01-将脚本添加到开机启动.png\\"],\\"datePublished\\":\\"2024-07-17T00:00:00.000Z\\",\\"dateModified\\":\\"2024-09-02T05:44:26.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"昌霖学长\\"}]}"]]},"headers":[{"level":2,"title":"编写脚本","slug":"编写脚本","link":"#编写脚本","children":[]},{"level":2,"title":"编辑 sudo 权限","slug":"编辑-sudo-权限","link":"#编辑-sudo-权限","children":[]},{"level":2,"title":"配置开机启动","slug":"配置开机启动","link":"#配置开机启动","children":[]}],"git":{"createdTime":1723779818000,"updatedTime":1725255866000,"contributors":[{"name":"Shawn Lyu","email":"shawnlyu1990@gmail.com","commits":3}]},"readingTime":{"minutes":2.98,"words":893},"filePathRelative":"posts/macOS/2024-07-17-开机自动执行脚本.md","localizedDate":"2024年7月17日","excerpt":"","copyright":{"license":"MIT"}}');export{c as comp,k as data};
