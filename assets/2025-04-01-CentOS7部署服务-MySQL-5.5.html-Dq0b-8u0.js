import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as t,d as a,a as i,b as h,e,w as d,r,o as p}from"./app-DDtGdiS6.js";const k="/assets/postsimages/2025-04-01-CentOS7%E9%83%A8%E7%BD%B2%E6%9C%8D%E5%8A%A1-MySQL-5.5/01-MySQL_Product_Archives.png",o={},c={class:"hint-container tip"};function g(y,s){const l=r("font");return p(),t("div",null,[s[5]||(s[5]=a(`<div class="hint-container important"><p class="hint-container-title">重要</p><p>由于作者水平有限，以下内容仅在我的环境中配置成功，这里提供思路供您参考。</p><p>因为每个环境各有差异，如果有些配置在您的环境中出现了一些异常错误，请您自行排查解决。</p><p><strong>以下所有操作，均在 CentOS 7.4.1708 版本中，使用 root 账号执行。</strong></p></div><h2 id="_1-准备环境" tabindex="-1"><a class="header-anchor" href="#_1-准备环境"><span>1. 准备环境</span></a></h2><h3 id="_1-1-准备编译和安装环境" tabindex="-1"><a class="header-anchor" href="#_1-1-准备编译和安装环境"><span>1.1. 准备编译和安装环境</span></a></h3><div class="code-block-with-title"><div class="code-block-title-bar" data-title="此操作位于 /root/ 目录下"><span>此操作位于 /root/ 目录下</span></div><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cmake</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gcc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gcc-c++</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ncurses</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ncurses-devel</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> libarchive</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> openssl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> openssl-devel</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> libtirpc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> libtirpc-devel</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bison</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> libaio-devel</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></div><div class="hint-container note"><p class="hint-container-title">参数解释</p><ul><li><strong>cmake</strong>：跨平台的构建系统。</li><li><strong>gcc-c++</strong>： C++ 编译器。</li><li><strong>ncurses-devel</strong>： 提供字符终端处理库。</li><li><strong>bison</strong>： 用于生成语法分析器。</li><li><strong>libaio-devel</strong>： 异步 I/O 库。</li></ul></div><h3 id="_1-2-创建-mysql-用户和组" tabindex="-1"><a class="header-anchor" href="#_1-2-创建-mysql-用户和组"><span>1.2. 创建 MySQL 用户和组</span></a></h3><div class="code-block-with-title"><div class="code-block-title-bar" data-title="此操作位于 /root/ 目录下"><span>此操作位于 /root/ 目录下</span></div><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">groupadd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysql</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">useradd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -r</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -g</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysql</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></div><h3 id="_1-3-创建-mysql-安装位置目录" tabindex="-1"><a class="header-anchor" href="#_1-3-创建-mysql-安装位置目录"><span>1.3. 创建 MySQL 安装位置目录</span></a></h3><div class="code-block-with-title"><div class="code-block-title-bar" data-title="此操作位于 /root/ 目录下"><span>此操作位于 /root/ 目录下</span></div><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/mysql-5.5.28/data/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></div><h2 id="_2-下载-mysql-源码包" tabindex="-1"><a class="header-anchor" href="#_2-下载-mysql-源码包"><span>2. 下载 MySQL 源码包</span></a></h2><p>从 <a href="https://downloads.mysql.com/archives/community/" target="_blank" rel="noopener noreferrer">MySQL 官方网站</a> 下载 MySQL 5.5.28 的源码包。</p><figure><img src="`+k+`" alt="MySQL 5.5.28 源码包" tabindex="0" loading="lazy"><figcaption>MySQL 5.5.28 源码包</figcaption></figure><p>可以使用 <code>wget</code> 命令从服务器中直接下载。</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="此操作位于 /root/ 目录下"><span>此操作位于 /root/ 目录下</span></div><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://downloads.mysql.com/archives/get/p/23/file/mysql-5.5.28.tar.gz</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></div><p>下载完成后，解压源码包</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="此操作位于 /root/ 目录下"><span>此操作位于 /root/ 目录下</span></div><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -zxvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysql-5.5.28.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysql-5.5.28</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="_3-编译-mysql" tabindex="-1"><a class="header-anchor" href="#_3-编译-mysql"><span>3. 编译 MySQL</span></a></h2><h3 id="_3-1-创建编译目录" tabindex="-1"><a class="header-anchor" href="#_3-1-创建编译目录"><span>3.1. 创建编译目录</span></a></h3><p>为了保持源码目录的整洁，建议创建一个专门的编译目录。</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="此操作位于 /root/mysql-5.5.28/ 目录下"><span>此操作位于 /root/mysql-5.5.28/ 目录下</span></div><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> build</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> build</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></div><h3 id="_3-2-运行-cmake" tabindex="-1"><a class="header-anchor" href="#_3-2-运行-cmake"><span>3.2. 运行 cmake</span></a></h3><p>使用 <code>cmake</code> 命令配置编译选项。</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="此操作位于 /root/mysql-5.5.28/build 目录下"><span>此操作位于 /root/mysql-5.5.28/build 目录下</span></div><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cmake</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ..</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -DCMAKE_INSTALL_PREFIX=/usr/local/mysql-5.5.28</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -DMYSQL_DATADIR=/usr/local/mysql-5.5.28/data</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -DSYSCONFDIR=/etc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -DMYSQL_USER=mysql</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -DDEFAULT_CHARSET=utf8</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -DDEFAULT_COLLATION=utf8_general_ci</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -DWITH_INNOBASE_STORAGE_ENGINE=1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -DWITH_ARCHIVE_STORAGE_ENGINE=1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -DWITH_BLACKHOLE_STORAGE_ENGINE=1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -DWITH_READLINE=1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -DWITH_SSL=system</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -DWITH_ZLIB=system</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -DWITH_LIBWRAP=0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></div><div class="hint-container note"><p class="hint-container-title">参数解释</p><ul><li><strong>CMAKE_INSTALL_PREFIX</strong>：指定MySQL的安装目录。</li><li><strong>MYSQL_DATADIR</strong>：指定数据文件的存储目录。</li><li><strong>SYSCONFDIR</strong>：指定配置文件(my.cnf)的存储目录。</li><li><strong>MYSQL_USER</strong>：指定数据库运行用户。</li><li><strong>DEFAULT_CHARSET</strong>：指定默认字符集。</li><li><strong>DEFAULT_COLLATION</strong>：指定默认排序字符集。</li><li><strong>WITH_INNOBASE_STORAGE_ENGINE</strong>：启用 InnoDB 存储引擎。</li><li><strong>WITH_ARCHIVE_STORAGE_ENGINE</strong>：启用 Archive 存储引擎。</li><li><strong>WITH_BLACKHOLE_STORAGE_ENGINE</strong>：启用Blackhole存储引擎。</li><li><strong>WITH_READLINE</strong>：启用 readline 库，提供命令行编辑功能。</li><li><strong>WITH_SSL</strong>：使用系统自带的 SSL 库。</li><li><strong>WITH_ZLIB</strong>：使用系统自带的 zlib 库。</li><li><strong>WITH_LIBWRAP</strong>：禁用 libwrap 库。</li></ul><p>其他参数可以参看下面这篇博客，这个博客里面介绍的比较完整。<br><a href="https://www.cnblogs.com/zx-admin/p/13409441.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/zx-admin/p/13409441.html</a></p></div><h3 id="_3-3-编译源码" tabindex="-1"><a class="header-anchor" href="#_3-3-编译源码"><span>3.3. 编译源码</span></a></h3><p>配置完成后，开始编译源码。</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="此操作位于 /root/mysql-5.5.28/build 目录下"><span>此操作位于 /root/mysql-5.5.28/build 目录下</span></div><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></div><p>编译过程需要耗费一定的时间。</p><h3 id="_3-4-安装-mysql" tabindex="-1"><a class="header-anchor" href="#_3-4-安装-mysql"><span>3.4. 安装 MySQL</span></a></h3><p>编译完成后，使用以下命令安装 MySQL。</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="此操作位于 /root/mysql-5.5.28/build 目录下"><span>此操作位于 /root/mysql-5.5.28/build 目录下</span></div><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></div><p>安装完成后，还需要对 MySQL 进行一些初始化操作。</p><h2 id="_4-配置-mysql" tabindex="-1"><a class="header-anchor" href="#_4-配置-mysql"><span>4. 配置 MySQL</span></a></h2><h3 id="_4-1-初始化数据库" tabindex="-1"><a class="header-anchor" href="#_4-1-初始化数据库"><span>4.1. 初始化数据库</span></a></h3><p>初始化数据库。</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="此操作位于 /root/ 目录下"><span>此操作位于 /root/ 目录下</span></div><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/usr/local/mysql-5.5.28/scripts/mysql_install_db</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --user=mysql</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --basedir=/usr/local/mysql-5.5.28</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --datadir=/usr/local/mysql-5.5.28/data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></div><h3 id="_4-2-配置数据库权限" tabindex="-1"><a class="header-anchor" href="#_4-2-配置数据库权限"><span>4.2. 配置数据库权限</span></a></h3><p>为了确保MySQL能够正常启动，需要设置正确的文件权限。</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="此操作位于 /root/ 目录下"><span>此操作位于 /root/ 目录下</span></div><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chown</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -R</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysql:mysql</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/mysql-5.5.28/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></div><h3 id="_4-3-启动-mysql" tabindex="-1"><a class="header-anchor" href="#_4-3-启动-mysql"><span>4.3. 启动 MySQL</span></a></h3><p>使用以下命令启动 MySQL 服务。</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="此操作位于 /root/ 目录下"><span>此操作位于 /root/ 目录下</span></div><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/usr/local/mysql/bin/mysqld_safe</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --user=mysql</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &amp;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></div><div class="hint-container warning"><p class="hint-container-title">注意</p><p>如果出现类似下面的报错，则需要手动创建 MySQL 日志目录和日志文件。</p><p><code>touch: cannot touch &#39;/var/log/mariadb/mariadb.log&#39;: No such file or directory</code></p><p><code>chown: cannot access &#39;/var/log/mariadb/mariadb.log&#39;: No such file or directory</code></p><p>解决方法：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/log/mariadb/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">touch</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/log/mariadb/mariadb.log</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chown</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -R</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysql:mysql</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/log/mariadb/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><div class="hint-container warning"><p class="hint-container-title">注意</p><p>如果出现类似下面的报错，则需要手动创建 MySQL 运行目录。<br><code>/usr/local/mysql-5.5.28/bin/mysqld: Can&#39;t create/write to file &#39;/var/run/mariadb/mariadb.pid&#39; (Errcode:2)</code></p><p>临时解决方法：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/run/mariadb/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">chown</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -R</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysql:mysql</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/run/mariadb/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>但是 <code>/var/run/</code> 是指向 <code>/run</code> 的软连接，<code>/run</code> 是挂载在临时文件的系统里的，即在系统启动后，添加在里面的数据、文件都是写入内存的，因此重启后手动写入的数据会丢失。</p><p>最好的办法是在 <code>/usr/lib/tmpfiles.d/</code> 目录中创建一个 <code>mysql.conf</code> 配置文件。因为 systemd-tmpfiles 会根据 <code>/etc/tmpfiles.d/*.conf</code>、<code>/run/tmpfiles.d/*.conf</code>、<code>/usr/lib/tmpfiles.d/*.conf</code> 三个位置的配置文件决定如何创建、删除、清理 易变文件与临时文件以及易变目录与临时目录。</p><p>彻底解决方法：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;d /run/mariadb 0755 mysql mysql -&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/usr/lib/tmpfiles.d/mysql.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>参考资料：<br><a href="https://insp.top/content/why-lost-tmpfile-after-system-reboot" target="_blank" rel="noopener noreferrer">https://insp.top/content/why-lost-tmpfile-after-system-reboot</a></p></div><div class="hint-container warning"><p class="hint-container-title">注意</p><p>如果出现类似下面的报错，则需要检查一下 <code>/etc/my.cnf</code> 的配置。</p><p><code> [ERROR] Can&#39;t open the mysql.plugin table. Please run mysql_upgrade to create it.</code></p><p><code> [ERROR] Fatal error: Can&#39;t open and lock privilege tables: Table &#39;mysql.host&#39; doesn&#39;t exist.</code></p><p>因为我就是需要当前这个版本，所以不考虑升级，那么需要检查一下 <code>/etc/my.cnf</code> 的配置是不是正确的。</p><p>我打开 <code>/etc/my.cnf</code> 文件之后，发现里面的内容中 <code>datadir</code> 行、 <code>basedir</code> 行和 <code>socket</code> 行与预期不一致，因此修改如下。</p><div class="code-block-with-title"><div class="code-block-title-bar" data-title="/etc/my.cnf"><span>/etc/my.cnf</span></div><div class="language-ssh-config line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="ssh-config" style="--vp-collapsed-lines:15;--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro has-diff vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[mysqld]</span></span>
<span class="line diff add"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">basedir=/usr/local/mysql-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">28</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/ </span></span>
<span class="line diff remove"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">datadir=/var/lib/mysql/ </span></span>
<span class="line diff add"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">datadir=/usr/local/mysql-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">28</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/data/ </span></span>
<span class="line diff remove"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">socket=/var/lib/mysql/mysql.sock </span></span>
<span class="line diff add"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">socket=/tmp/mysql.sock  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Disabling symbolic-links is recommended to prevent assorted security risks</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">symbolic-links=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Settings user and group are ignored when systemd is used.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># If you need to run mysqld under a different user or group,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># customize your systemd unit file for mariadb according to the</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># instructions in http://fedoraproject.org/wiki/Systemd</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[mysqld_safe]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">log-error=/var/log/mariadb/mariadb.log</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">pid-file=/var/run/mariadb/mariadb.pid</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># include all files from the config directory</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">!includedir /</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;" class="highlighted-word">etc</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/my.cnf.d</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>我的环境中，处理完上面三个问题，就可以正常启动了，如果还是无法正常启动还可以尝试一下重新初始化数据库。</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/usr/local/mysql-5.5.28/bin/mysqld</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --initialize</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --user=mysql</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --console</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">或者</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/usr/local/mysql-5.5.28/scripts/mysql_install_db</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --user=mysql</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --basedir=/usr/local/mysql-5.5.28</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --datadir=/usr/local/mysql-5.5.28/data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果还是报错，我也没什么办法了，再查询一下其他资料，或根据报错具体问题具体分析吧。</p></div><h3 id="_4-4-设置-root-密码" tabindex="-1"><a class="header-anchor" href="#_4-4-设置-root-密码"><span>4.4. 设置 root 密码</span></a></h3><p>启动 MySQL 后，需要设置 root 用户的密码。</p><p>首先，登录 MySQL</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/usr/local/mysql-5.5.28/bin/mysql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>然后，执行以下 SQL 命令设置密码</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SET</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> PASSWORD</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> FOR</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;root&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;localhost&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> PASSWORD</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;your_password&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="hint-container note"><p class="hint-container-title">注</p><p>将 <code>your_password</code> 替换为你想要的密码。</p></div><h3 id="_4-5-放行所有-ip-访问数据库-根据实际需求配置" tabindex="-1"><a class="header-anchor" href="#_4-5-放行所有-ip-访问数据库-根据实际需求配置"><span>4.5. 放行所有 IP 访问数据库（根据实际需求配置）</span></a></h3><p>首先，登录 MySQL 数据库</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/usr/local/mysql/bin/mysql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>放行所有 IP 地址</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">GRANT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ALL PRIVILEGES </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ON</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> *.* </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">TO</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;root&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;%&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> IDENTIFIED </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">BY</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;your_password&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> WITH</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> GRANT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> OPTION</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="hint-container note"><p class="hint-container-title">注</p><ul><li><p>将 <code>your_password</code> 替换为你想要的密码。</p></li><li><p>其中 第一个 <code>*</code> 表示数据库名；第二个 <code>*</code> 表示该数据库的表名；如果像上面那样 <code>*.*</code> 的话表示所有到数据库下到所有表都允许访问；</p></li><li><p><code>%</code> 是通配符，表示允许访问到 MySQL 的 IP 地址；当然你也可以配置为具体的 IP 地址；<code>%</code> 表示所有 IP 均可以访问；</p></li></ul></div><h3 id="_4-6-配置-mysql-为全局命令" tabindex="-1"><a class="header-anchor" href="#_4-6-配置-mysql-为全局命令"><span>4.6. 配置 mysql 为全局命令</span></a></h3><p>将 <code>/usr/local/mysql-5.5.28/bin/mysql</code> 软连接到 <code>/usr/bin/</code> 目录下。</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ln</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/mysql-5.5.28/bin/mysql</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/bin/mysql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_4-7-配置-mysql-服务" tabindex="-1"><a class="header-anchor" href="#_4-7-配置-mysql-服务"><span>4.7. 配置 MySQL 服务</span></a></h3><p>为了方便管理，可以将 MySQL 设置为系统服务。</p><p>创建一个服务脚本文件</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/systemd/system/mysqld.service</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="code-block-with-title"><div class="code-block-title-bar" data-title="/etc/systemd/system/mysqld.service"><span>/etc/systemd/system/mysqld.service</span></div><div class="language-ssh-config line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="ssh-config" style="--vp-collapsed-lines:15;--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 添加以下内容</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[Unit]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Description=MySQL Server</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">After=network.target</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">After=syslog.target</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[Install]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">WantedBy=multi-user.target</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[Service]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Type=simple</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">User</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=mysql</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Group=mysql</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ExecStart=/usr/local/mysql-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">28</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/bin/mysqld_safe --user=mysql</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ExecReload=/bin/kill -s </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">HUP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> $</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">MAINPID</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ExecStop=/usr/local/mysql-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">28</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/bin/mysqladmin -u root -p shutdown</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Restart=on-failure</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div></div>`,67)),i("div",c,[s[1]||(s[1]=i("p",{class:"hint-container-title"},"提示",-1)),s[2]||(s[2]=i("p",null,[i("strong",null,[e("之前将上面 [Service] 中的 Type 字段错误配置成了 "),i("code",null,"Type=forking"),e("。导致出现了执行 "),i("code",null,"systemctl start mysqld"),e(" 的时候卡住，等了1分钟才报错。之后在网络上找了好多资料，发现了问题，在此记录。")])],-1)),s[3]||(s[3]=i("p",null,[i("strong",null,"导致此问题的原因是：")],-1)),h(l,{color:"red"},{default:d(()=>s[0]||(s[0]=[i("b",null,"mysqld.service 类型(Type)选择有问题, 不应该选 forking 类型，类型改为 Type=simple（或删除 Type=forking 这句），问题便得到解决。",-1)])),_:1}),s[4]||(s[4]=a('<p>关于 Type 的种类和解释如下：</p><ul><li><p><strong><code>Type=oneshot</code></strong>：这一选项适用于只执行一项任务、随后立即退出的服务。可能需要同时设置 <code>RemainAfterExit=yes</code> 使得 systemd 在服务进程退出之后仍然认为服务处于激活状态。</p></li><li><p><strong><code>Type=notify</code></strong>：与 <code>Type=simple</code> 相同，但约定服务会在就绪后向 systemd 发送一个信号。这一通知的实现由 <code>libsystemd-daemon.so</code> 提供。</p></li><li><p><strong><code>Type=dbus</code></strong>：若以此方式启动，当指定的 <code>BusName</code> 出现在 DBus 系统总线上时，systemd 认为服务就绪。</p></li><li><p><strong><code>Type=idle</code></strong>：systemd 会等待所有任务处理完成后，才开始执行 <code>idle</code> 类型的单元。其他行为与 <code>Type=simple</code> 类似。</p></li><li><p><strong><code>Type=forking</code></strong>：systemd 认为当该服务进程 fork，且父进程退出后服务启动成功。对于常规的守护进程（daemon），除非你确定此启动方式无法满足需求，使用此类型启动即可。使用此启动类型应同时指定 <code>PIDFile=xxx</code>，以便 systemd 能够跟踪服务的主进程。</p></li><li><p><strong><code>Type=simple</code></strong>（默认值）：systemd 认为该服务将立即启动。服务进程不会 fork 。如果该服务要启动其他服务，不要使用此类型启动，除非该服务是 socket 激活型。</p></li></ul><p>从上表可以看到，当类型为 forking 时，systemd 会认为所运行当该服务本身是守护进程即本身会 fork，且只有父进程退出后 systemd 才会退出，但由于参考例子并不是守护进程，故 systemd 一直处于阻塞等待状态，默认的 simple 无等待这一环节。</p><p>参考资料：<br><a href="https://blog.csdn.net/pang_2899/article/details/105994439" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/pang_2899/article/details/105994439</a><br><a href="https://blog.csdn.net/Sardkit/article/details/79911925" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/Sardkit/article/details/79911925</a></p>',4))]),s[6]||(s[6]=a(`<p>重新加载服务配置文件。</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> daemon-reload</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>启用并启动 MySQL 服务。</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysqld</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysqld</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-验证安装" tabindex="-1"><a class="header-anchor" href="#_5-验证安装"><span>5. 验证安装</span></a></h2><p>重启数据库服务器，使用以下命令登录 MySQL 数据库</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysql</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -u</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>输入你设置的密码，如果能够成功登录，说明 MySQL 安装成功。</p><h2 id="_6-配置防火墙" tabindex="-1"><a class="header-anchor" href="#_6-配置防火墙"><span>6. 配置防火墙</span></a></h2><p>为了确保外部主机可以访问 MySQL 服务，需要配置防火墙。</p><p>使用以下命令开放 3306 端口</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --permanent</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --add-port=3306/tcp</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">firewall-cmd</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --reload</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_7-参考" tabindex="-1"><a class="header-anchor" href="#_7-参考"><span>7. 参考</span></a></h2><ol><li>《CentOS 7下从源码编译安装MySQL 5.5的详细步骤与配置指南》 <a href="https://www.oryoy.com/news/centos-7-xia-cong-yuan-ma-bian-yi-an-zhuang-mysql-5-5-de-xiang-xi-bu-zhou-yu-pei-zhi-zhi-nan.html" target="_blank" rel="noopener noreferrer">https://www.oryoy.com/news/centos-7-xia-cong-yuan-ma-bian-yi-an-zhuang-mysql-5-5-de-xiang-xi-bu-zhou-yu-pei-zhi-zhi-nan.html</a></li><li>《Linux CentOS7安装MySQL5.5.28》 <a href="https://blog.csdn.net/qq_48049033/article/details/143316255" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/qq_48049033/article/details/143316255</a></li><li>《mysql编译选项说明》 <a href="https://www.jianshu.com/p/fe946fa0c24d" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/fe946fa0c24d</a></li></ol>`,14))])}const A=n(o,[["render",g]]),v=JSON.parse('{"path":"/posts/Config/Linux/%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2/2025-04-01-CentOS7%E9%83%A8%E7%BD%B2%E6%9C%8D%E5%8A%A1-MySQL-5.5.html","title":"CentOS 7 部署服务 - MySQL 5.5.28 (源码编译)","lang":"zh-CN","frontmatter":{"title":"CentOS 7 部署服务 - MySQL 5.5.28 (源码编译)","shortTitle":"CentOS 7 部署服务 - MySQL 5.5.28 (源码编译)","description":"MySQL 5.5.28 其实是比较老的版本了，官方只提供了 CentOS 4、5、6 版本的 RPM 包，但因为一些原因需要在 CentOS 7 中安装部署 MySQL 5.5.28 版本，找了很多资料，最终只能使用源码编译安装的方法。这里记录一下我的安装过程，已备后续参考。","icon":"/assets/blogicons/数据库服务器.png","author":"昌霖学长","isOriginal":true,"date":"2025-04-01T00:00:00.000Z","categories":["Linux","服务部署"],"tags":["MySQL"],"license":"MIT","sticky":false,"star":false,"article":true,"timeline":true,"comment":false,"head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"CentOS 7 部署服务 - MySQL 5.5.28 (源码编译)\\",\\"image\\":[\\"https://shawnlyu1990.github.io/assets/postsimages/2025-04-01-CentOS7部署服务-MySQL-5.5/01-MySQL_Product_Archives.png\\"],\\"datePublished\\":\\"2025-04-01T00:00:00.000Z\\",\\"dateModified\\":\\"2025-04-16T03:33:02.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"昌霖学长\\"}]}"],["meta",{"property":"og:url","content":"https://shawnlyu1990.github.io/posts/Config/Linux/%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2/2025-04-01-CentOS7%E9%83%A8%E7%BD%B2%E6%9C%8D%E5%8A%A1-MySQL-5.5.html"}],["meta",{"property":"og:site_name","content":"昌霖学长的自习室"}],["meta",{"property":"og:title","content":"CentOS 7 部署服务 - MySQL 5.5.28 (源码编译)"}],["meta",{"property":"og:description","content":"MySQL 5.5.28 其实是比较老的版本了，官方只提供了 CentOS 4、5、6 版本的 RPM 包，但因为一些原因需要在 CentOS 7 中安装部署 MySQL 5.5.28 版本，找了很多资料，最终只能使用源码编译安装的方法。这里记录一下我的安装过程，已备后续参考。"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://shawnlyu1990.github.io/assets/postsimages/2025-04-01-CentOS7部署服务-MySQL-5.5/01-MySQL_Product_Archives.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-04-16T03:33:02.000Z"}],["meta",{"property":"article:author","content":"昌霖学长"}],["meta",{"property":"article:tag","content":"MySQL"}],["meta",{"property":"article:published_time","content":"2025-04-01T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-04-16T03:33:02.000Z"}]]},"git":{"createdTime":1743559602000,"updatedTime":1744774382000,"contributors":[{"name":"Shawn Lyu","username":"","email":"shawnlyu1990@gmail.com","commits":4}]},"readingTime":{"minutes":9.41,"words":2822},"filePathRelative":"posts/Config/Linux/服务部署/2025-04-01-CentOS7部署服务-MySQL-5.5.md","excerpt":"","copyright":{"license":"MIT"}}');export{A as comp,v as data};
